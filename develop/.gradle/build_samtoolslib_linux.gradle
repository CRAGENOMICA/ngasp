/**
 * ============================================================================
 *  \brief     samtoolslib_linux_build.gradle
 *  \details   This file describes the samtools library build process for LINUX
 *  \author    jjene
 *  \version   1.0
 *  \date      Apr 29, 2016
 *  \pre
 *  \bug
 *  \warning
 *  \copyright CRAG 2015.
 * ============================================================================
 */
apply plugin: 'c'

/*
--------------------------------------------------------------------------------
Attention:

The current working directory is this file's folder: ".gradle/"
--------------------------------------------------------------------------------
*/


task wrapper(type: Wrapper) {
    gradleVersion = '2.11'
}

model {
	toolChains {
		gcc(Gcc) {
			path "/usr/bin"
			eachPlatform() {
				cppCompiler.executable "gcc" /* not g++ because this project is C */
			}
		}
  }

	components {
		samtoolslib(NativeLibrarySpec) {
			sources {
				c {
					source {
						srcDirs "../source/samtoolslib", "../source/samtoolslib/htslib-1.3.1/cram", "../source/samtoolslib/htslib-1.3.1/htslib", "../source/samtoolslib/htslib-1.3.1", "../source/samtoolslib/win32"
						include "**/*.c"
					}
          exportedHeaders {
						srcDirs "../source/samtoolslib/", "../source/samtoolslib/htslib-1.3.1/cram", "../source/samtoolslib/htslib-1.3.1/htslib", "../source/samtoolslib/htslib-1.3.1", "../source/samtoolslib/win32"
          }
				}
      }

      binaries.all {
          cCompiler.args "-Wall",
                         "-O2",
                         "-c",
                         "-g",
                         "-I.",
                         "-Ihtslib-1.3.1"
                         ""

      }		
		}
	}
}

task build_and_export_lib(type: Copy, dependsOn:build) {
  from "./build/libs/samtoolslib/static/libsamtoolslib.a"
  into "/develop/webapp/bin"
}

